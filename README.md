# DuckDB FIT Extension

This repository is based on the [DuckDB extension template](https://github.com/duckdb/extension-template).

This extension allows you to read Garmin `.fit` files using DuckDB, providing access to GPS tracks, heart rate data, power metrics, and other sensor information from fitness devices.

## Table Functions

| Function                   | Description                                        |
| -------------------------- | -------------------------------------------------- |
| `fit_records(filename)`    | Main records table with GPS tracks and sensor data |
| `fit_activities(filename)` | Activity metadata and summaries                    |
| `fit_sessions(filename)`   | Training session information                       |
| `fit_laps(filename)`       | Individual lap data and splits                     |
| `fit_devices(filename)`    | Device information and sensor details              |
| `fit_events(filename)`     | Activity events and markers                        |
| `fit_users(filename)`      | User profile information                           |

### Example

`SELECT * FROM fit_records('sample.fit') LIMIT 5;`

| timestamp              | latitude           | longitude           | altitude | enhanced_altitude | distance | speed | enhanced_speed | vertical_speed | power | motor_power | accumulated_power | compressed_accumulated_power | heart_rate | total_hemoglobin_conc | total_hemoglobin_conc_min | total_hemoglobin_conc_max | saturated_hemoglobin_percent | saturated_hemoglobin_percent_min | saturated_hemoglobin_percent_max | cadence | cadence256 | fractional_cadence | temperature | core_temperature | grade | resistance | left_right_balance | left_torque_effectiveness | right_torque_effectiveness | left_pedal_smoothness | right_pedal_smoothness | combined_pedal_smoothness | left_pco | right_pco | vertical_oscillation | stance_time_percent | stance_time | stance_time_balance | step_length | vertical_ratio | cycle_length | cycle_length16 | cycles | total_cycles | time_from_course | gps_accuracy | calories | zone | activity_type | stroke_type | time128 | grit | flow | current_stress | ebike_travel_range | ebike_battery_level | ebike_assist_mode | ebike_assist_level_percent | battery_soc | ball_speed | absolute_pressure | depth | next_stop_depth | next_stop_time | time_to_surface | ndl_time | cns_load | n2_load | air_time_remaining | pressure_sac | volume_sac | rmv  | ascent_rate | po2  | respiration_rate | enhanced_respiration_rate | device_index | file_source |
| ---------------------- | ------------------ | ------------------- | -------- | ----------------- | -------- | ----- | -------------- | -------------- | ----- | ----------- | ----------------- | ---------------------------- | ---------- | --------------------- | ------------------------- | ------------------------- | ---------------------------- | -------------------------------- | -------------------------------- | ------- | ---------- | ------------------ | ----------- | ---------------- | ----- | ---------- | ------------------ | ------------------------- | -------------------------- | --------------------- | ---------------------- | ------------------------- | -------- | --------- | -------------------- | ------------------- | ----------- | ------------------- | ----------- | -------------- | ------------ | -------------- | ------ | ------------ | ---------------- | ------------ | -------- | ---- | ------------- | ----------- | ------- | ---- | ---- | -------------- | ------------------ | ------------------- | ----------------- | -------------------------- | ----------- | ---------- | ----------------- | ----- | --------------- | -------------- | --------------- | -------- | -------- | ------- | ------------------ | ------------ | ---------- | ---- | ----------- | ---- | ---------------- | ------------------------- | ------------ | ----------- |
| 2025-09-27 20:06:48+00 | 51.18182751350105  | -115.57556913234293 | -223.0   | -223.0            | 0.02     | 0.002 | 0.002          | NULL           | NULL  | NULL        | NULL              | NULL                         | 93         | NULL                  | NULL                      | NULL                      | NULL                         | NULL                             | NULL                             | NULL    | NULL       | NULL               | NULL        | NULL             | NULL  | NULL       | NULL               | NULL                      | NULL                       | NULL                  | NULL                   | NULL                      | NULL     | NULL      | NULL                 | NULL                | NULL        | NULL                | NULL        | NULL           | NULL         | NULL           | NULL   | NULL         | NULL             | NULL         | NULL     | NULL | E-Biking      |             | NULL    | NULL | NULL | NULL           | NULL               | NULL                | NULL              | NULL                       | NULL        | NULL       | NULL              | NULL  | NULL            | NULL           | NULL            | NULL     | NULL     | NULL    | NULL               | NULL         | NULL       | NULL | NULL        | NULL | NULL             | NULL                      | NULL         | sample.fit  |
| 2025-09-27 20:06:49+00 | 51.18182365782559  | -115.57554624974728 | -223.0   | -223.0            | 0.03     | 0.001 | 0.001          | NULL           | NULL  | NULL        | NULL              | NULL                         | 93         | NULL                  | NULL                      | NULL                      | NULL                         | NULL                             | NULL                             | NULL    | NULL       | NULL               | NULL        | NULL             | NULL  | NULL       | NULL               | NULL                      | NULL                       | NULL                  | NULL                   | NULL                      | NULL     | NULL      | NULL                 | NULL                | NULL        | NULL                | NULL        | NULL           | NULL         | NULL           | NULL   | NULL         | NULL             | NULL         | NULL     | NULL | E-Biking      |             | NULL    | NULL | NULL | NULL           | NULL               | NULL                | NULL              | NULL                       | NULL        | NULL       | NULL              | NULL  | NULL            | NULL           | NULL            | NULL     | NULL     | NULL    | NULL               | NULL         | NULL       | NULL | NULL        | NULL | NULL             | NULL                      | NULL         | sample.fit  |
| 2025-09-27 20:06:50+00 | 51.18182751350105  | -115.57552336715162 | -223.0   | -223.0            | 0.05     | 0.002 | 0.002          | NULL           | NULL  | NULL        | NULL              | NULL                         | 94         | NULL                  | NULL                      | NULL                      | NULL                         | NULL                             | NULL                             | NULL    | NULL       | NULL               | NULL        | NULL             | NULL  | NULL       | NULL               | NULL                      | NULL                       | NULL                  | NULL                   | NULL                      | NULL     | NULL      | NULL                 | NULL                | NULL        | NULL                | NULL        | NULL           | NULL         | NULL           | NULL   | NULL         | NULL             | NULL         | NULL     | NULL | E-Biking      |             | NULL    | NULL | NULL | NULL           | NULL               | NULL                | NULL              | NULL                       | NULL        | NULL       | NULL              | NULL  | NULL            | NULL           | NULL            | NULL     | NULL     | NULL    | NULL               | NULL         | NULL       | NULL | NULL        | NULL | NULL             | NULL                      | NULL         | sample.fit  |
| 2025-09-27 20:06:51+00 | 51.181831285357475 | -115.57549285702407 | -223.0   | -223.0            | 0.07     | 0.002 | 0.002          | NULL           | NULL  | NULL        | NULL              | NULL                         | 94         | NULL                  | NULL                      | NULL                      | NULL                         | NULL                             | NULL                             | NULL    | NULL       | NULL               | NULL        | NULL             | NULL  | NULL       | NULL               | NULL                      | NULL                       | NULL                  | NULL                   | NULL                      | NULL     | NULL      | NULL                 | NULL                | NULL        | NULL                | NULL        | NULL           | NULL         | NULL           | NULL   | NULL         | NULL             | NULL         | NULL     | NULL | E-Biking      |             | NULL    | NULL | NULL | NULL           | NULL               | NULL                | NULL              | NULL                       | NULL        | NULL       | NULL              | NULL  | NULL            | NULL           | NULL            | NULL     | NULL     | NULL    | NULL               | NULL         | NULL       | NULL | NULL        | NULL | NULL             | NULL                      | NULL         | sample.fit  |
| 2025-09-27 20:06:52+00 | 51.181831285357475 | -115.57545463554561 | -223.0   | -223.0            | 0.09     | 0.002 | 0.002          | NULL           | NULL  | NULL        | NULL              | NULL                         | 94         | NULL                  | NULL                      | NULL                      | NULL                         | NULL                             | NULL                             | NULL    | NULL       | NULL               | NULL        | NULL             | NULL  | NULL       | NULL               | NULL                      | NULL                       | NULL                  | NULL                   | NULL                      | NULL     | NULL      | NULL                 | NULL                | NULL        | NULL                | NULL        | NULL           | NULL         | NULL           | NULL   | NULL         | NULL             | NULL         | NULL     | NULL | E-Biking      |             | NULL    | NULL | NULL | NULL           | NULL               | NULL                | NULL              | NULL                       | NULL        | NULL       | NULL              | NULL  | NULL            | NULL           | NULL            | NULL     | NULL     | NULL    | NULL               | NULL         | NULL       | NULL | NULL        | NULL | NULL             | NULL                      | NULL         | sample.fit  |

`SELECT * FROM fit_activities('sample.fit');`

| activity_id | file_id | timestamp              | local_timestamp        | start_time             | total_timer_time | total_elapsed_time | total_distance | sport    | sub_sport | manufacturer | product       | device_serial_number | software_version | total_calories | total_ascent | total_descent | avg_heart_rate | max_heart_rate | avg_speed            | max_speed            | avg_power | max_power | avg_cadence | max_cadence | start_position_lat | start_position_long | end_position_lat | end_position_long | file_source |
| ----------- | ------- | ---------------------- | ---------------------- | ---------------------- | ---------------- | ------------------ | -------------- | -------- | --------- | ------------ | ------------- | -------------------- | ---------------- | -------------- | ------------ | ------------- | -------------- | -------------- | -------------------- | -------------------- | --------- | --------- | ----------- | ----------- | ------------------ | ------------------- | ---------------- | ----------------- | ----------- |
| 0           |         | 2025-09-28 00:33:53+00 | 2025-09-27 18:33:53+00 | 2025-09-27 20:06:48+00 | 7.931            | 16.025             | 359.3244921875 | E-Biking | Generic   | Development  | Intervals.icu | 0                    |                  | 0              | 438.0        | 410.0         | 94             | 133            | 0.004544000148773194 | 0.013026000022888184 | NULL      | NULL      | NULL        | NULL        | NULL               | NULL                | NULL             | NULL              | sample.fit  |

## Development

```bash
# Build the extension
GEN=ninja make

# Install and load
./build/release/duckdb
```
