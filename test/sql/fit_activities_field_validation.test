# name: test/sql/fit_activities_field_validation.test
# description: Test case for fit_activities field population
# group: [sql]

require fit

# Load test data
statement ok
CREATE TEMP TABLE test_activities AS SELECT * FROM fit_activities('./sample.fit');

statement ok
CREATE TEMP TABLE test_sessions AS SELECT * FROM fit_sessions('./sample.fit');

# Test 1: Sport field should be human-readable string from session data
query I
SELECT (SELECT sport FROM test_activities) = (SELECT sport FROM test_sessions);
----
true

# Test 2: Sub-sport field should be human-readable string from session data
query I
SELECT (SELECT sub_sport FROM test_activities) = (SELECT sub_sport FROM test_sessions);
----
true

# Test 3: Manufacturer should be human-readable, not numeric code
query I
SELECT (SELECT manufacturer FROM test_activities) NOT LIKE '%255%' AND
       (SELECT manufacturer FROM test_activities) IS NOT NULL;
----
true

# Test 4: Distance data should be copied from session to activity
query I
SELECT (SELECT total_distance FROM test_activities) = (SELECT total_distance FROM test_sessions);
----
true

# Test 5: Heart rate data should be copied from session to activity
query I
SELECT (SELECT avg_heart_rate FROM test_activities) = (SELECT avg_heart_rate FROM test_sessions) AND
       (SELECT max_heart_rate FROM test_activities) = (SELECT max_heart_rate FROM test_sessions);
----
true

# Test 6: Speed data should be copied from session to activity
query I
SELECT (SELECT avg_speed FROM test_activities) = (SELECT avg_speed FROM test_sessions) AND
       (SELECT max_speed FROM test_activities) = (SELECT max_speed FROM test_sessions);
----
true

# Test 7: Elapsed time should be copied from session to activity
query I
SELECT (SELECT total_elapsed_time FROM test_activities) = (SELECT total_elapsed_time FROM test_sessions);
----
true

# Test 8: Ascent/descent data should be copied from session to activity
query I
SELECT (SELECT total_ascent FROM test_activities) = (SELECT total_ascent FROM test_sessions) AND
       (SELECT total_descent FROM test_activities) = (SELECT total_descent FROM test_sessions);
----
true

# Clean up
statement ok
DROP TABLE test_activities;

statement ok
DROP TABLE test_sessions;
